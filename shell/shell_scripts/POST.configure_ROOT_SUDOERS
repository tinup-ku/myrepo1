#!/bin/bash -x
#==============================================================================
#Change Log:
#
# When          Who             What
# ----          ---             ----
# 06.25.2012    J. Wu		Add ulse to the sudoers file by default
# 02.25.2014	J Ritter	Add TADDM to the sudoers file
#
#==============================================================================

echo "Add ulse to the sudoers file in /etc/sudoers.d/" >> ${INSTLOG}

cat >> /etc/sudoers.d/ulse << EOF
#
# %ulse team is allowed to root access
#
%ulse	ALL=(ALL)   ALL
EOF

chmod 0400 /etc/sudoers.d/ulse
visudo -c -f /etc/sudoers.d/ulse >> ${INSTLOG}


echo "Add TADDM to the sudoers file in /etc/sudoers.d/" >> ${INSTLOG}
cat >> /etc/sudoers.d/taddm << EOF
#
# TADDM sudo access
#

# Defaults specification
# User ztaddmulse does not require tty
Defaults:ztaddmulse     !requiretty

Cmnd_Alias TDM_CMD1 = /usr/bin/lsof, /usr/sbin/lsof, /opt/csw/bin/lsof, /bin/ps *, /usr/ucb/ps *, /usr/sbin/dmidecode, /bin/cat, /sbin/mii-tool, /usr/sbin/mii-tool, /sbin/ethtool, /usr/sbin/ethtool, /sbin/lvdisplay *, /sbin/vgdisplay *, /sbin/pvdisplay *, /bin/ls, /usr/bin/cksum, /bin/df *, /bin/dd *, /usr/bin/dd *, /bin/crontab *, /usr/bin/crontab *, /usr/sbin/prtvtoc, /sbin/vmcp, /usr/sbin/lpfc/lputil, /opt/VRTSvcs/bin/haclus -display, /opt/VRTSvcs/bin/hastatus, /sbin/vxprint, /sbin/vxlicrep

ztaddmulse	ALL=(root)   NOPASSWD:TDM_CMD1
EOF

chmod 0400 /etc/sudoers.d/taddm
visudo -c -f /etc/sudoers.d/taddm >> ${INSTLOG}

exit 0

