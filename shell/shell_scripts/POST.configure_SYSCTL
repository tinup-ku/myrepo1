#!/bin/bash -x

#==============================================================================
#Change Log:
#
# When          Who     	What
# ----          ---     	----
# 09.04.2013 	J. Wu		Created inital script for setting sysctl 
#
#==============================================================================

function config_network_sysctl {
    # Configure sysctl/network settings
    SYSCTL_SETTING=( net.ipv4.conf.all.accept_source_route:0
    net.ipv4.conf.default.accept_source_route:0
    net.ipv4.tcp_max_syn_backlog:4096
    net.ipv4.conf.all.rp_filter:1
    net.ipv4.conf.default.rp_filter:1
    net.ipv4.tcp_syncookies:1
    net.ipv4.conf.all.send_redirects:0
    net.ipv4.conf.default.send_redirects:0
    net.ipv4.conf.all.accept_redirects:0
    net.ipv4.conf.default.accept_redirects:0
    net.ipv4.icmp_echo_ignore_broadcasts:1
    net.ipv4.conf.all.log_martians:1
    net.ipv4.tcp_timestamps:0
    net.ipv4.conf.all.secure_redirects:0
    net.ipv4.conf.default.secure_redirects:0 )

    echo "# TD Ameritrade settings" >> /etc/sysctl.conf
    for SYSSETTING in ${SYSCTL_SETTING[@]}
    do
        SYSCTL_P="`echo ${SYSSETTING} | cut -d":" -f1`"
        SYSCTL_S="`echo ${SYSSETTING} | cut -d":" -f2`"

        sed -i".${INPLACE}" '/${SYSCTL_P}/d' /etc/sysctl.conf
        echo "${SYSCTL_P} = ${SYSCTL_S}" >> /etc/sysctl.conf
    done
} ## End config_network_sysctl

config_network_sysctl

exit 0
